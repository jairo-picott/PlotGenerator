<!DOCTYPE html>
<html>

<head>
	<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>
	<div id="myDiv"></div>
	<script>
		function fetchDataAndPlot(sensorData) {
  			fetch('https://twin-app.netlify.app/.netlify/functions/proxy', {
    			method: 'POST',
    			headers: {
      				'Content-Type': 'application/json',
    			},
    			body: JSON.stringify(sensorData),
  			})
  			.then(response => response.json())
  			.then(data => {
    			const traces = data.map(item => ({
      				x: item.map(point => new Date(point.last_changed)),
      				y: item.map(point => point.state),
      				mode: 'lines',
      				name: item[0].entity_id,
    			}));
  
    			const layout = {
      				title: 'Sensor Data',
    			};
  
    			Plotly.newPlot('myDiv', traces, layout);
  			})
  			.catch((error) => {
    			console.error('Error:', error);
  			});
		}
	</script>
</body>

</html>
